<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>openai</title><meta name="description" content="Documentation for openai"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">openai</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>openai</h1></div><div class="tsd-panel tsd-typography"><h1 id="jdr-generator-api-openai" class="tsd-anchor-link">JDR-Generator API (OpenAI)<a href="#jdr-generator-api-openai" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><h2 id="description" class="tsd-anchor-link">Description<a href="#description" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Ce module est une application Node.js/Express/TypeScript conçue pour fournir une API REST permettant de générer des images à l'aide de l'API DALL-E d'OpenAI. Il sert d'alternative au module Gemini pour la génération d'images, offrant une flexibilité basée sur la disponibilité et les fonctionnalités de l'API.</p>
<h2 id="caractéristiques" class="tsd-anchor-link">Caractéristiques<a href="#caractéristiques" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Génération d'images avec DALL-E :</strong> Fournit un point de terminaison <code>/illustrate</code> pour générer des images à partir d'une invite textuelle.</li>
<li><strong>Configuration flexible :</strong> Configurable via des variables d'environnement (PORT, API_KEY, DOWNLOAD_FOLDER).</li>
<li><strong>Intégration facile :</strong> Peut être intégré dans des projets Node.js ou utilisé comme service autonome.</li>
</ul>
<h2 id="technologies-utilisées" class="tsd-anchor-link">Technologies Utilisées<a href="#technologies-utilisées" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>Node.js</li>
<li>Express (pour le serveur web)</li>
<li>TypeScript</li>
<li>OpenAI API (DALL-E)</li>
</ul>
<h2 id="configuration" class="tsd-anchor-link">Configuration<a href="#configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ol>
<li><strong>Obtenir une clé API OpenAI :</strong></li>
</ol>
<ul>
<li>Rendez-vous sur la plateforme OpenAI : <a href="https://platform.openai.com/">https://platform.openai.com/</a></li>
<li>Créez un compte ou connectez-vous.</li>
<li>Générez une nouvelle clé secrète dans la section &quot;API keys&quot;.</li>
<li><strong>Important :</strong> Conservez cette clé en sécurité et ne la partagez jamais publiquement.</li>
</ul>
<ol start="2">
<li><strong>Variables d'environnement :</strong></li>
</ol>
<ul>
<li>
<p>Créez un fichier <code>.env</code> à la racine du répertoire de ce module.</p>
</li>
<li>
<p>Vous pouvez également configurer ces variables dans votre fichier <code>docker-compose.yml</code> si vous utilisez Docker.</p>
</li>
<li>
<p>Ajoutez les variables suivantes au fichier <code>.env</code> :</p>
<ul>
<li><code>PORT</code>: Le port sur lequel le serveur Express écoutera (par exemple, 3002).</li>
<li><code>API_KEY</code>: Votre clé API OpenAI secrète.</li>
<li><code>DOWNLOAD_FOLDER</code>: Le nom du sous-dossier dans <code>/app/downloads/</code> où les images générées seront enregistrées à l'intérieur du conteneur Docker (doit correspondre à la configuration de votre service API et aux montages de volume, si applicable). Si vous n'utilisez pas Docker, ce sera le chemin relatif dans votre système de fichiers.</li>
</ul>
</li>
<li>
<p>Exemple de fichier <code>.env</code> :</p>
<pre><code><span class="hl-0">PORT</span><span class="hl-1">=</span><span class="hl-2">3002</span><br/><span class="hl-0">API_KEY</span><span class="hl-1">=</span><span class="hl-3">sk</span><span class="hl-1">-</span><span class="hl-3">votre</span><span class="hl-1">-</span><span class="hl-3">cle</span><span class="hl-1">-</span><span class="hl-3">api</span><span class="hl-1">-</span><span class="hl-3">openai</span><br/><span class="hl-0">DOWNLOAD_FOLDER</span><span class="hl-1">=</span><span class="hl-3">jdr</span><span class="hl-1">-</span><span class="hl-3">generator</span>
</code><button>Copy</button></pre>

</li>
</ul>
<ol start="3">
<li><strong>Installer les dépendances :</strong></li>
</ol>
<ul>
<li>
<p>Assurez-vous que Node.js et npm (ou yarn) sont installés.</p>
</li>
<li>
<p>Ouvrez un terminal dans le répertoire du module et exécutez :</p>
<pre><code class="bash"><span class="hl-4">npm</span><span class="hl-1"> </span><span class="hl-5">install</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
<h2 id="utilisation" class="tsd-anchor-link">Utilisation<a href="#utilisation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="exécution-de-lapplication" class="tsd-anchor-link">Exécution de l'application<a href="#exécution-de-lapplication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ol>
<li><strong>Compiler le code TypeScript (si nécessaire) :</strong></li>
</ol>
<ul>
<li>
<p>Si vous n'avez pas encore compilé le code TypeScript, exécutez :</p>
<pre><code class="bash"><span class="hl-4">npm</span><span class="hl-1"> </span><span class="hl-5">run</span><span class="hl-1"> </span><span class="hl-5">build</span><span class="hl-1"> </span><span class="hl-6"># ou tsc</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
<ol start="2">
<li><strong>Démarrer le serveur :</strong></li>
</ol>
<ul>
<li>
<p>Exécutez la commande suivante pour démarrer le serveur Express :</p>
<pre><code class="bash"><span class="hl-4">npm</span><span class="hl-1"> </span><span class="hl-5">run</span><span class="hl-1"> </span><span class="hl-5">start</span><span class="hl-1"> </span><span class="hl-6"># ou node dist/index.js (si vous avez compilé manuellement)</span>
</code><button type="button">Copy</button></pre>

</li>
<li>
<p>Le serveur écoutera sur le port spécifié dans la variable d'environnement <code>PORT</code> (par défaut, 3002).</p>
</li>
</ul>
<h3 id="api-endpoint" class="tsd-anchor-link">API Endpoint<a href="#api-endpoint" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>
<p><strong><code>POST /illustrate</code></strong></p>
<ul>
<li>
<p><strong>Description :</strong> Génère une image à partir d'une invite textuelle.</p>
</li>
<li>
<p><strong>Méthode :</strong> <code>POST</code></p>
</li>
<li>
<p><strong>URL :</strong> <code>http://localhost:{PORT}/illustrate</code> (Remplacez <code>{PORT}</code> par le port configuré, par exemple, <code>http://localhost:3002/illustrate</code>)</p>
</li>
<li>
<p><strong>Corps de la requête :</strong></p>
<ul>
<li>
<p><strong>Format :</strong> JSON</p>
</li>
<li>
<p><strong>Exemple :</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;prompt&quot;</span><span class="hl-1">: </span><span class="hl-5">&quot;Un portrait d&#39;un guerrier elfe avec une armure dorée, éclairé par la lumière du soleil couchant.&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
</li>
<li>
<p><strong>Réponse :</strong></p>
<ul>
<li>
<p><strong>Format :</strong> JSON</p>
</li>
<li>
<p><strong>Contenu :</strong> Un objet JSON contenant des informations sur l'image générée. Cela peut inclure :</p>
<ul>
<li><code>imageUrl</code>: Une URL vers l'image générée.</li>
<li><code>imageData</code>: Les données de l'image encodées (par exemple, en base64).</li>
<li><code>localFilePath</code>: Le chemin du fichier où l'image a été enregistrée (si l'API l'enregistre localement).</li>
</ul>
</li>
<li>
<p><strong>Exemple de réponse :</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;imageUrl&quot;</span><span class="hl-1">: </span><span class="hl-5">&quot;[https://example.com/images/image_123.png](https://example.com/images/image_123.png)&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;localFilePath&quot;</span><span class="hl-1">: </span><span class="hl-5">&quot;/app/downloads/jdr-generator/image_123.png&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="gestion-des-erreurs" class="tsd-anchor-link">Gestion des erreurs<a href="#gestion-des-erreurs" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>
<p>L'API doit renvoyer des codes d'état HTTP appropriés en cas d'erreur (par exemple, 400 Bad Request pour une requête invalide, 500 Internal Server Error en cas d'erreur côté serveur).</p>
</li>
<li>
<p>Les réponses d'erreur doivent inclure un message JSON descriptif.</p>
<ul>
<li>
<p>Exemple de réponse d'erreur :</p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;error&quot;</span><span class="hl-1">: </span><span class="hl-5">&quot;L&#39;invite est requise.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">&quot;code&quot;</span><span class="hl-1">: </span><span class="hl-5">&quot;MISSING_PROMPT&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
</li>
</ul>
<h2 id="intégration-de-github-actions" class="tsd-anchor-link">Intégration de GitHub Actions<a href="#intégration-de-github-actions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Ce projet utilise GitHub Actions pour automatiser à la fois les vérifications de la qualité du code et le déploiement des images Docker.
Cette approche permet d'assurer un code de haute qualité et de simplifier le processus de déploiement.</p>
<h3 id="workflow-de-qualité-du-code" class="tsd-anchor-link">Workflow de Qualité du Code<a href="#workflow-de-qualité-du-code" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>La qualité du code est vérifiée automatiquement à chaque <em>push</em> et <em>pull request</em> grâce à un workflow GitHub Actions défini dans le fichier <code>.github/workflows/code-quality.yml</code>.
Ce workflow contient une section dédiée à la partie du projet <code>nodejs-code-quality-openai</code> et s'exécute depuis toutes les branches.</p>
<p><strong>Fonctionnement :</strong></p>
<ul>
<li>Le workflow vérifie la qualité du code à chaque <em>push</em> et <em>pull request</em> sur toutes les branches.</li>
<li>Des vérifications spécifiques sont exécutées pour ce module Node.js.</li>
<li>Les résultats des vérifications sont disponibles dans l'interface GitHub Actions.</li>
</ul>
<p><strong>Étapes du workflow de qualité du code :</strong></p>
<ol>
<li><strong>Checkout du code :</strong> Récupère la dernière version du code source.</li>
<li><strong>Configuration de Node.js :</strong> Configure l'environnement Node.js avec la version spécifiée.</li>
<li><strong>Installation des dépendances :</strong> Installe les dépendances du projet.</li>
<li><strong>Vérifications :</strong></li>
</ol>
<ul>
<li><strong>Linting :</strong> ESLint est utilisé pour vérifier le style et la qualité du code.</li>
<li><strong>Formatage :</strong> Prettier est utilisé pour formater le code de manière cohérente.</li>
<li><strong>Compilation :</strong> Le code TypeScript est compilé pour détecter les erreurs de typage.</li>
</ul>
<h3 id="workflow-de-déploiement-continu-avec-docker" class="tsd-anchor-link">Workflow de Déploiement Continu avec Docker<a href="#workflow-de-déploiement-continu-avec-docker" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Le déploiement des images Docker est également automatisé via GitHub Actions avec le workflow défini dans <code>.github/workflows/docker-push.yml</code>.
Ce workflow construit et publie les images Docker vers Docker Hub lorsqu'un <em>push</em> est effectué sur les branches spécifiées (actuellement <code>githubactions</code> et <code>main</code>).</p>
<p><strong>Fonctionnement :</strong></p>
<ul>
<li>Le workflow ne construit et ne pousse une image Docker que si des modifications sont détectées dans le dossier source correspondant (ici openai/).</li>
<li>Il est possible de déclencher manuellement le workflow pour forcer la reconstruction de toutes les images.</li>
<li>Cette approche optimise le temps d'exécution et l'utilisation des ressources.</li>
</ul>
<p><strong>Étapes du workflow de déploiement :</strong></p>
<ol>
<li><strong>Checkout du code :</strong> Récupère la dernière version du code source.</li>
<li><strong>Connexion à Docker Hub :</strong> Utilise les secrets GitHub <code>DOCKERHUB_USERNAME</code> et <code>DOCKERHUB_TOKEN</code> pour se connecter au compte Docker Hub.</li>
<li><strong>Build et push des images :</strong> Pour ce module 'openai', l'image Docker est construite et taguée avec le SHA du commit actuel ainsi que le tag <code>latest</code>, puis les deux tags sont poussés vers Docker Hub. Les images sont disponibles sur ce repo : <a href="https://hub.docker.com/repositories/eli256">https://hub.docker.com/repositories/eli256</a></li>
</ol>
<p>En combinant ces deux workflows GitHub Actions, cela assure à la fois la qualité du code et un déploiement efficace et automatisé de l'application.</p>
<h2 id="sécurité" class="tsd-anchor-link">Sécurité<a href="#sécurité" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Clé API :</strong> Sécurisez votre clé API OpenAI. Ne l'incluez jamais directement dans votre code. Utilisez toujours des variables d'environnement.</li>
<li><strong>Validation :</strong> Validez les données d'entrée (par exemple, la longueur et le format de l'invite) pour éviter les erreurs et les abus.</li>
<li><strong>Limitation de débit :</strong> Envisagez d'implémenter une limitation de débit pour éviter la surcharge de l'API OpenAI et les coûts excessifs.</li>
</ul>
<h2 id="licence" class="tsd-anchor-link">Licence<a href="#licence" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="markdow">Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#jdr-generator-api-openai"><span>JDR-<wbr/>Generator <wbr/>API (<wbr/>Open<wbr/>AI)</span></a><ul><li><a href="#description"><span>Description</span></a></li><li><a href="#caractéristiques"><span>Caractéristiques</span></a></li><li><a href="#technologies-utilisées"><span>Technologies <wbr/>Utilisées</span></a></li><li><a href="#configuration"><span>Configuration</span></a></li><li><a href="#utilisation"><span>Utilisation</span></a></li><li><ul><li><a href="#exécution-de-lapplication"><span>Exécution de l&#39;application</span></a></li><li><a href="#api-endpoint"><span>API <wbr/>Endpoint</span></a></li><li><a href="#gestion-des-erreurs"><span>Gestion des erreurs</span></a></li></ul></li><li><a href="#intégration-de-github-actions"><span>Intégration de <wbr/>Git<wbr/>Hub <wbr/>Actions</span></a></li><li><ul><li><a href="#workflow-de-qualité-du-code"><span>Workflow de <wbr/>Qualité du <wbr/>Code</span></a></li><li><a href="#workflow-de-déploiement-continu-avec-docker"><span>Workflow de <wbr/>Déploiement <wbr/>Continu avec <wbr/>Docker</span></a></li></ul></li><li><a href="#sécurité"><span>Sécurité</span></a></li><li><a href="#licence"><span>Licence</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">openai</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
